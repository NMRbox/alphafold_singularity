Bootstrap: localimage
From: base.sif

# Build instructions from
# https://github.com/kalininalab/alphafold_non_docker


%post
    # miniconda setup
    cd /opt/
    wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh && bash Miniconda3-latest-Linux-x86_64.sh -b -p /opt/miniconda3
    . /opt/miniconda3/etc/profile.d/conda.sh
    conda create --name alphafold python==3.8
    conda update -y -n base conda
    conda activate alphafold

    conda install -y -c conda-forge openmm==7.5.1 pdbfixer==1.7
    #cudnn==8.4.1.50
    #conda install -y -c "nvidia/label/cuda-12.1.0" cuda-toolkit==12.1.0
    conda install -y -c bioconda hmmer==3.3.2 hhsuite==3.3.0 kalign2==2.04

